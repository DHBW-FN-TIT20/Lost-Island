<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: systems/InteractionHelper.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: systems/InteractionHelper.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import {
    Vector2,
    Vector3,
    Raycaster
} from 'three';

/**
 * Object that allows you to connect Functions and Object if the camera are near the object
 */
class InteractionHelper {

    #registerdObjects;
    #registerdFunctions;
    #registerdEvents;
    #raycaster;
    #camera;
    #pointer;

    /**
     * @param {THREE.Camera} camera 
     */
    constructor(camera) {
        this.#registerdObjects = [];
        this.#registerdFunctions = {};
        this.#registerdEvents = {};
        this.#camera = camera;
        this.#raycaster = new Raycaster(new Vector3(), new Vector3(1, 0, 0), 0, 10);
        this.#pointer = new Vector2(0, 0);
    }

    /**
     * Add Object and Funktion to check
     * @param {THREE.MESH} object Mesh for Raycast
     * @param {function} func Executed if the camera is near the object
     * @param {String} event If set, add a Listener to the body with given name for example "keydown". Default to null.
     * @param {function} eventFunc Function of the Event to add. Default to null.
     */
    addInteraction(object, func, event = null, eventFunc = null) {
        this.#registerdObjects.push(object);
        this.#registerdFunctions[object.uuid] = func;
        this.#registerdEvents[object.uuid] = {
            "name": event,
            "func": eventFunc,
            "isSet": false
        };
    }

    /**
     * Remove Object to check
     * @param {THREE.MESH} object Mesh for Raycast
     */
    removeInteraction(object) {
        delete this.#registerdFunctions[object.uuid];
        delete this.#registerdEvents[object.uuid];

        const index = this.#registerdObjects.indexOf(object);
        if (index >= 0) {
            this.#registerdObjects.splice(index, 1);
        }
    }


    /**
     * Needs to be called to check if the camera is near the object
     * @see https://github.com/mrdoob/three.js/blob/f021ec0c9051eb11d110b0c2b93305bffd0942e0/examples/webgl_raycaster_sprite.html#L138
     */
    checkInteractions() {
        this.#raycaster.setFromCamera(this.#pointer, this.#camera);
        const intersects = this.#raycaster.intersectObjects(this.#registerdObjects, false);

        let div = document.getElementById("info");
        div.innerHTML = "&amp;#8982;";

        // Remove all Eventlistener from all objects
        for (const key in this.#registerdEvents) {
            if (this.#registerdEvents[key]["isSet"]) {
                document.body.removeEventListener(this.#registerdEvents[key]["name"], this.#registerdEvents[key]["func"]);
                this.#registerdEvents[key]["isSet"] = false;
            }
        }

        // In range for intersection
        if (intersects.length > 0) {

            const res = intersects[0];

            if (res &amp;&amp; res.object) {
                // Execute the function
                this.#registerdFunctions[res.object.uuid]();

                // Add Eventlistener if needed
                if (this.#registerdEvents[res.object.uuid]["name"] &amp;&amp; !this.#registerdEvents[res.object.uuid]["isSet"]) {
                    document.body.addEventListener(this.#registerdEvents[res.object.uuid]["name"], this.#registerdEvents[res.object.uuid]["func"]);
                    this.#registerdEvents[res.object.uuid]["isSet"] = true;

                }
            }
        }

    }
}

export { InteractionHelper };</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BallBuilder.html">BallBuilder</a></li><li><a href="BeachHouseBuilder.html">BeachHouseBuilder</a></li><li><a href="BoatBuilder.html">BoatBuilder</a></li><li><a href="ChairBuilder.html">ChairBuilder</a></li><li><a href="ColissionBoxBuilder.html">ColissionBoxBuilder</a></li><li><a href="Controller.html">Controller</a></li><li><a href="CrateBuilder.html">CrateBuilder</a></li><li><a href="InteractionHelper.html">InteractionHelper</a></li><li><a href="KeyBoardWatcher.html">KeyBoardWatcher</a></li><li><a href="Loop.html">Loop</a></li><li><a href="PierBuilder.html">PierBuilder</a></li><li><a href="Resizer.html">Resizer</a></li><li><a href="SharkBuilder.html">SharkBuilder</a></li><li><a href="UmbrellaBuilder.html">UmbrellaBuilder</a></li><li><a href="VegetationBuilder.html">VegetationBuilder</a></li><li><a href="WolfBuilder.html">WolfBuilder</a></li><li><a href="World.html">World</a></li></ul><h3>Global</h3><ul><li><a href="global.html#createAmbientLight">createAmbientLight</a></li><li><a href="global.html#createGround">createGround</a></li><li><a href="global.html#createGroundWithDisplacementMap">createGroundWithDisplacementMap</a></li><li><a href="global.html#createOcean">createOcean</a></li><li><a href="global.html#createPerspectiveCamera">createPerspectiveCamera</a></li><li><a href="global.html#createRenderer">createRenderer</a></li><li><a href="global.html#createRock">createRock</a></li><li><a href="global.html#createScene">createScene</a></li><li><a href="global.html#createSky">createSky</a></li><li><a href="global.html#createSpotLight">createSpotLight</a></li><li><a href="global.html#createSun">createSun</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.0</a> on Tue Nov 15 2022 20:49:41 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
